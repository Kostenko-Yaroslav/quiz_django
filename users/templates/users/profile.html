{% extends 'base.html' %}

{% block title %}–ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å{% endblock %}

{% block main %}

<div class="grid">

    <article>
        <header style="text-align: center;">
            <img
                src="https://ui-avatars.com/api/?name={{ user.username }}&background=0D47A1&color=fff&size=128"
                alt="Avatar"
                style="border-radius: 50%; margin-bottom: 1rem;"
            >
            <h2>{{ user.username }}</h2>
        </header>

        <p><strong>Email:</strong> {{ user.email|default:"‚Äî" }}</p>
        <p><strong>–î–∞—Ç–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó:</strong> {{ user.date_joined|date:"d.m.Y" }}</p>

        <footer>
            <form method="post" action="{% url 'users:logout' %}">
                {% csrf_token %}
                <button type="submit" class="secondary outline" style="width:100%">
                    –í–∏–π—Ç–∏ –∑ –∞–∫–∞—É–Ω—Ç—É
                </button>
            </form>

        </footer>
    </article>

    <article>
        <header>
            <strong>üìä –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</strong>
        </header>

        <div class="grid" style="text-align: center;">
            <div>
                <h3 style="margin-bottom: 0;">{{ user.userprofile.xp }}</h3>
                <small>–í—Å—å–æ–≥–æ XP</small>
            </div>
            <div>
                <h3 style="margin-bottom: 0;">{{ total_attempts }}</h3>
                <small>–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç—ñ–≤</small>
            </div>
            <div>
                <h3 style="margin-bottom: 0; color: var(--pico-ins-color);">
                    {{ avg_accuracy }}%
                </h3>
                <small>–¢–æ—á–Ω—ñ—Å—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π</small>
            </div>
        </div>

        <hr>

        <div style="margin-top: 2rem;">
            <h6>üèÜ –î–æ—Å—è–≥–Ω–µ–Ω–Ω—è</h6>

            <div class="grid" style="text-align: center;">
                {% for ua in achievements %}
                    <span
                        data-tooltip="{{ ua.achievement.description }}"
                        style="cursor: help;"
                    >
                        üèÖ {{ ua.achievement.title }}
                    </span>
                {% empty %}
                    <span>–ù–µ–º–∞—î –¥–æ—Å—è–≥–Ω–µ–Ω—å</span>
                {% endfor %}
            </div>
        </div>
    </article>

</div>

<article>
    <header>
        <strong>üïì –Ü—Å—Ç–æ—Ä—ñ—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ</strong>
    </header>

    <table class="striped">
        <thead>
            <tr>
                <th>–ù–∞–∑–≤–∞ —Ç–µ—Å—Ç—É</th>
                <th>–î–∞—Ç–∞</th>
                <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–î—ñ—è</th>
            </tr>
        </thead>
        <tbody>
            {% for attempt in attempts %}
                <tr>
                    <td>{{ attempt.level.name }}</td>
                    <td>{{ attempt.date|date:"d.m.Y" }}</td>
                    <td>{{ attempt.correct_answers }} / {{ attempt.total_question }}</td>
                    <td>
                        {% if attempt.percentage >= 80 %}
                            <span style="color: var(--pico-ins-color);">–í—ñ–¥–º—ñ–Ω–Ω–æ</span>
                        {% elif attempt.percentage >= 50 %}
                            <span style="color: #e6a23c;">–î–æ–±—Ä–µ</span>
                        {% else %}
                            <span style="color: var(--pico-del-color);">–ü—Ä–æ–≤–∞–ª</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{% url 'quiz:quiz_result' attempt.id %}">
                            –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏
                        </a>
                    </td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="5">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î —Å–ø—Ä–æ–±</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</article>

{% endblock %}
